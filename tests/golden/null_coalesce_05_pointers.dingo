package main

// Test: Null coalescing with Go raw pointers
// Feature: ?? operator with pointer types
// Complexity: intermediate

type User struct {
	name string
	age  int
}

func main() {
	// Test 1: Pointer ?? literal (separate ?. and ??)
	let user: *User = getUser(1)
	let nameOpt = user?.name
	let name = nameOpt ?? "Unknown"

	// Test 2: Pointer ?? pointer
	let primary: *string = getPrimary()
	let fallback: *string = getFallback()
	let result = primary ?? fallback

	// Test 3: Nested pointer access (separate ?. and ??)
	let userPtr: *User = getUser(2)
	let ageOpt = userPtr?.age
	let age = ageOpt ?? 0

	// Test 4: Nil pointer handling (separate ?. and ??)
	let nilUser: *User = nil
	let nilNameOpt = nilUser?.name
	let nilName = nilNameOpt ?? "Default"

	println("Name:", name)
	println("Age:", age)
	println("Nil:", nilName)
}

func getUser(id int) *User {
	if id == 1 {
		return &User{name: "Alice", age: 30}
	}
	return nil
}

func getPrimary() *string {
	return nil
}

func getFallback() *string {
	s := "Fallback"
	return &s
}
