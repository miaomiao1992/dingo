package main

// Test: Chained method calls with safe navigation operator
// Feature: Safe Navigation (?.) - Chained Methods
// Complexity: intermediate

type UserOption_Tag int

const (
	UserOption_Tag_Some UserOption_Tag = iota
	UserOption_Tag_None
)

type UserOption struct {
	tag  UserOption_Tag
	some *User
}

func UserOption_Some(value User) UserOption {
	return UserOption{tag: UserOption_Tag_Some, some: &value}
}

func UserOption_None() UserOption {
	return UserOption{tag: UserOption_Tag_None, some: nil}
}

func (o UserOption) IsSome() bool {
	return o.tag == UserOption_Tag_Some
}

func (o UserOption) IsNone() bool {
	return o.tag == UserOption_Tag_None
}

func (o UserOption) Unwrap() User {
	if o.IsNone() {
		panic("called Unwrap on None")
	}
	return *o.some
}

type StringOption_Tag int

const (
	StringOption_Tag_Some StringOption_Tag = iota
	StringOption_Tag_None
)

type StringOption struct {
	tag  StringOption_Tag
	some *string
}

func StringOption_Some(value string) StringOption {
	return StringOption{tag: StringOption_Tag_Some, some: &value}
}

func StringOption_None() StringOption {
	return StringOption{tag: StringOption_Tag_None, some: nil}
}

func (o StringOption) IsSome() bool {
	return o.tag == StringOption_Tag_Some
}

func (o StringOption) IsNone() bool {
	return o.tag == StringOption_Tag_None
}

func (o StringOption) Unwrap() string {
	if o.IsNone() {
		panic("called Unwrap on None")
	}
	return *o.some
}

func (s StringOption) toUpper() StringOption {
	if s.IsNone() {
		return StringOption_None()
	}
	str := s.Unwrap()
	// Simplified uppercase conversion
	return StringOption_Some(str)
}

type ProfileOption_Tag int

const (
	ProfileOption_Tag_Some ProfileOption_Tag = iota
	ProfileOption_Tag_None
)

type ProfileOption struct {
	tag  ProfileOption_Tag
	some *Profile
}

func ProfileOption_Some(value Profile) ProfileOption {
	return ProfileOption{tag: ProfileOption_Tag_Some, some: &value}
}

func ProfileOption_None() ProfileOption {
	return ProfileOption{tag: ProfileOption_Tag_None, some: nil}
}

func (o ProfileOption) IsSome() bool {
	return o.tag == ProfileOption_Tag_Some
}

func (o ProfileOption) IsNone() bool {
	return o.tag == ProfileOption_Tag_None
}

func (o ProfileOption) Unwrap() Profile {
	if o.IsNone() {
		panic("called Unwrap on None")
	}
	return *o.some
}

type User struct {
	name string
}

type Profile struct {
	bio string
}

func (u User) getName() StringOption {
	if u.name != "" {
		return StringOption_Some(u.name)
	}
	return StringOption_None()
}

func (p Profile) getBio() StringOption {
	if p.bio != "" {
		return StringOption_Some(p.bio)
	}
	return StringOption_None()
}

func (u User) getProfile() ProfileOption {
	return ProfileOption_Some(Profile{bio: "Engineer"})
}

func getUser(id int) UserOption {
	if id > 0 {
		return UserOption_Some(User{name: "Alice"})
	}
	return UserOption_None()
}

func main() {
	user := getUser(1)

	// Chained methods on same type: user?.getName()?.toUpper()
	upperName := func() StringOption {
		if user.IsNone() {
			return StringOption_None()
		}
		_user := user.Unwrap()

		_tmp0 := _user.getName()

		if _tmp0.IsNone() {
			return StringOption_None()
		}
		_tmp1 := _tmp0.Unwrap()

		return _tmp1.toUpper()
	}()
	println(upperName)

	// Chained methods across types: user?.getProfile()?.getBio()
	bio := func() StringOption {
		if user.IsNone() {
			return StringOption_None()
		}
		_user := user.Unwrap()

		_tmp2 := _user.getProfile()

		if _tmp2.IsNone() {
			return StringOption_None()
		}
		_tmp3 := _tmp2.Unwrap()

		return _tmp3.getBio()
	}()
	println(bio)
}
