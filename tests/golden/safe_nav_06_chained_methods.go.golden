package main

type UserOptionTag uint8

const (
	UserOptionTagSome UserOptionTag = iota
	UserOptionTagNone
)

type UserOption struct {
	tag  UserOptionTag
	some *User
}

func UserOptionSome(arg0 User) UserOption {
	return UserOption{tag: UserOptionTagSome, some: &arg0}
}
func UserOptionNone() UserOption {
	return UserOption{tag: UserOptionTagNone}
}
func (e UserOption) IsSome() bool {
	return e.tag == UserOptionTagSome
}
func (e UserOption) IsNone() bool {
	return e.tag == UserOptionTagNone
}
func (o UserOption) Map(fn func(User) User) UserOption {
	switch o.tag {
	case UserOptionTagSome:
		if o.some != nil {
			return UserOptionSome(fn(*o.some))
		}
	case UserOptionTagNone:
		return o
	}
	panic("invalid UserOption state")
}
func (o UserOption) AndThen(fn func(User) UserOption) UserOption {
	switch o.tag {
	case UserOptionTagSome:
		if o.some != nil {
			return fn(*o.some)
		}
	case UserOptionTagNone:
		return o
	}
	panic("invalid UserOption state")
}

type StringOptionTag uint8

const (
	StringOptionTagSome StringOptionTag = iota
	StringOptionTagNone
)

type StringOption struct {
	tag  StringOptionTag
	some *string
}
func StringOptionSome(arg0 string) StringOption {
	return StringOption{tag: StringOptionTagSome, some: &arg0}
}
func StringOptionNone() StringOption {
	return StringOption{tag: StringOptionTagNone}
}
func (e StringOption) IsSome() bool {
	return e.tag == StringOptionTagSome
}
func (e StringOption) IsNone() bool {
	return e.tag == StringOptionTagNone
}
func (o StringOption) Map(fn func(string) string) StringOption {
	switch o.tag {
	case StringOptionTagSome:
		if o.some != nil {
			return StringOptionSome(fn(*o.some))
		}
	case StringOptionTagNone:
		return o
	}
	panic("invalid StringOption state")
}
func (o StringOption) AndThen(fn func(string) StringOption) StringOption {
	switch o.tag {
	case StringOptionTagSome:
		if o.some != nil {
			return fn(*o.some)
		}
	case StringOptionTagNone:
		return o
	}
	panic("invalid StringOption state")
}

type ProfileOptionTag uint8

const (
	ProfileOptionTagSome ProfileOptionTag = iota
	ProfileOptionTagNone
)

type ProfileOption struct {
	tag  ProfileOptionTag
	some *Profile
}
func ProfileOptionSome(arg0 Profile) ProfileOption {
	return ProfileOption{tag: ProfileOptionTagSome, some: &arg0}
}
func ProfileOptionNone() ProfileOption {
	return ProfileOption{tag: ProfileOptionTagNone}
}
func (e ProfileOption) IsSome() bool {
	return e.tag == ProfileOptionTagSome
}
func (e ProfileOption) IsNone() bool {
	return e.tag == ProfileOptionTagNone
}
func (o ProfileOption) Map(fn func(Profile) Profile) ProfileOption {
	switch o.tag {
	case ProfileOptionTagSome:
		if o.some != nil {
			return ProfileOptionSome(fn(*o.some))
		}
	case ProfileOptionTagNone:
		return o
	}
	panic("invalid ProfileOption state")
}
func (o ProfileOption) AndThen(fn func(Profile) ProfileOption) ProfileOption {
	switch o.tag {
	case ProfileOptionTagSome:
		if o.some != nil {
			return fn(*o.some)
		}
	case ProfileOptionTagNone:
		return o
	}
	panic("invalid ProfileOption state")
}

type User struct {
	name string
}
type Profile struct {
	bio string
}
func (u User) getName() StringOption {
	if u.name != "" {
		return StringOptionSome(u.name)
	}
	return StringOptionNone()
}
func (s StringOption) toUpper() StringOption {
	if s.IsNone() {
		return StringOptionNone()
	}
	str := s.Unwrap()

	return StringOptionSome(str)
}
func (u User) getProfile() ProfileOption {
	return ProfileOptionSome(Profile{bio: "Engineer"})
}
func (p Profile) getBio() StringOption {
	if p.bio != "" {
		return StringOptionSome(p.bio)
	}
	return StringOptionNone()
}
func getUser(id int) UserOption {
	if id > 0 {
		return UserOptionSome(User{name: "Alice"})
	}
	return UserOptionNone()
}
func main() {
	user := getUser(1)

	upperName := user
	println(upperName)

	bio := user
	println(bio)
}
