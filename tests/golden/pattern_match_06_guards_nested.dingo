package main

// Test: Guards with 'where' keyword (Swift-style)
// Feature: Swift-style 'where' guards with complex boolean expressions
// Complexity: intermediate
// Limitation: where guards with NESTED patterns not yet supported

enum Option {
	Some(int),
	None,
}

enum Result {
	Ok(int),
	Err(error),
}

// Using 'where' keyword (Swift-style)
func analyzeValue(opt Option) string {
	return match opt {
		OptionSome(x) where x > 100 => "large",
		OptionSome(x) where x > 10 => "medium",
		OptionSome(x) where x > 0 => "small",
		OptionSome(_) => "non-positive",
		OptionNone => "none",
	}
}

// Simple pattern with where guards (NOT nested)
func processResult(result Result) string {
	return match result {
		ResultOk(val) where val > 100 => "large value",
		ResultOk(val) where val > 0 => "positive value",
		ResultOk(_) => "non-positive value",
		ResultErr(_) => "error",
	}
}

// Guard fallthrough demonstration
func categorize(opt Option) string {
	return match opt {
		OptionSome(x) where x%3 == 0 && x%5 == 0 => "fizzbuzz",
		OptionSome(x) where x%3 == 0 => "fizz",
		OptionSome(x) where x%5 == 0 => "buzz",
		OptionSome(x) => "number",
		OptionNone => "empty",
	}
}

func main() {
	println(analyzeValue(OptionSome(150)))
	println(processResult(ResultOk(42)))
	println(categorize(OptionSome(15)))
}
