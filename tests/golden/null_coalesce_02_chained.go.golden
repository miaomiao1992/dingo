package main

type OptionTag uint8

const (
	OptionTagSome OptionTag = iota
	OptionTagNone
)

type Option struct {
	tag    OptionTag
	some *string
}

func Option_Some(arg0 string) Option {
	return Option{tag: OptionTagSome, some: &arg0}
}
func Option_None() Option {
	return Option{tag: OptionTagNone}
}
func (e Option) IsSome() bool {
	return e.tag == OptionTagSome
}
func (e Option) IsNone() bool {
	return e.tag == OptionTagNone
}
func main() {
	var firstName Option = Option_None()
	var middleName Option = Option_None()
	var lastName Option = Option_Some("Smith")
	// Chained null coalescing - try each in order
	var name string
	if firstName.IsSome() {
		name = *firstName.some
	} else if middleName.IsSome() {
		name = *middleName.some
	} else if lastName.IsSome() {
		name = *lastName.some
	} else {
		name = "Unknown"
	}
	// With function calls
	primary := getConfig("primary")
	fallback := getConfig("fallback")
	var config string
	if primary.IsSome() {
		config = *primary.some
	} else if fallback.IsSome() {
		config = *fallback.some
	} else {
		config = "default"
	}
	println("Name:", name)
	println("Config:", config)
}
func getConfig(key string) Option {
	if key == "fallback" {
		return Option_Some("backup-value")
	}
	return Option_None()
}
