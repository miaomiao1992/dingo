package main

type User struct {
	name string
	age  int
}

func main() {

	user := getUser(1)
	nameOpt := func() __INFER__ {
		if user == nil {
			return nil
		}
		return user.name
	}()
	name := func() __INFER__ {
		if nameOpt.IsSome() {
			return __UNWRAP__(nameOpt)
		}
		return "Unknown"
	}()

	primary := getPrimary()
	fallback := getFallback()
	result := func() __INFER__ {
		if primary != nil {
			return *primary
		}
		return fallback
	}()

	userPtr := getUser(2)
	ageOpt := func() __INFER__ {
		if userPtr == nil {
			return nil
		}
		return userPtr.age
	}()
	age := func() __INFER__ {
		if ageOpt.IsSome() {
			return __UNWRAP__(ageOpt)
		}
		return 0
	}()

	nilUser := nil
	nilNameOpt := func() __INFER__ {
		if nilUser == nil {
			return nil
		}
		return nilUser.name
	}()
	nilName := func() __INFER__ {
		if nilNameOpt.IsSome() {
			return __UNWRAP__(nilNameOpt)
		}
		return "Default"
	}()

	println("Name:", name)
	println("Age:", age)
	println("Nil:", nilName)
}
func getUser(id int) *User {
	if id == 1 {
		return &User{name: "Alice", age: 30}
	}
	return nil
}
func getPrimary() *string {
	return nil
}
func getFallback() *string {
	s := "Fallback"
	return &s
}
