package main

type StringOptionTag uint8

const (
	StringOptionTagSome StringOptionTag = iota
	StringOptionTagNone
)

type StringOption struct {
	tag  StringOptionTag
	some *string
}

func StringOptionSome(arg0 string) StringOption {
	return StringOption{tag: StringOptionTagSome, some: &arg0}
}
func StringOptionNone() StringOption {
	return StringOption{tag: StringOptionTagNone}
}
func (e StringOption) IsSome() bool {
	return e.tag == StringOptionTagSome
}
func (e StringOption) IsNone() bool {
	return e.tag == StringOptionTagNone
}
func (o StringOption) Map(fn func(string) string) StringOption {
	switch o.tag {
	case StringOptionTagSome:
		if o.some != nil {
			return StringOptionSome(fn(*o.some))
		}
	case StringOptionTagNone:
		return o
	}
	panic("invalid StringOption state")
}
func (o StringOption) AndThen(fn func(string) StringOption) StringOption {
	switch o.tag {
	case StringOptionTagSome:
		if o.some != nil {
			return fn(*o.some)
		}
	case StringOptionTagNone:
		return o
	}
	panic("invalid StringOption state")
}

type IntOptionTag uint8

const (
	IntOptionTagSome IntOptionTag = iota
	IntOptionTagNone
)

type IntOption struct {
	tag  IntOptionTag
	some *int
}
func IntOptionSome(arg0 int) IntOption {
	return IntOption{tag: IntOptionTagSome, some: &arg0}
}
func IntOptionNone() IntOption {
	return IntOption{tag: IntOptionTagNone}
}
func (e IntOption) IsSome() bool {
	return e.tag == IntOptionTagSome
}
func (e IntOption) IsNone() bool {
	return e.tag == IntOptionTagNone
}
func (o IntOption) Map(fn func(int) int) IntOption {
	switch o.tag {
	case IntOptionTagSome:
		if o.some != nil {
			return IntOptionSome(fn(*o.some))
		}
	case IntOptionTagNone:
		return o
	}
	panic("invalid IntOption state")
}
func (o IntOption) AndThen(fn func(int) IntOption) IntOption {
	switch o.tag {
	case IntOptionTagSome:
		if o.some != nil {
			return fn(*o.some)
		}
	case IntOptionTagNone:
		return o
	}
	panic("invalid IntOption state")
}
func main() {

	name := getUserName()
	displayName := func() string {
		if name.IsSome() {
			return name.Unwrap()
		}
		return "Guest"
	}()

	fallback := StringOptionSome("Default")
	result := func() __INFER__ {
		if name.IsSome() {
			return name.Unwrap()
		}
		return fallback
	}()

	count := getCount()
	finalCount := func() int {
		if count.IsSome() {
			return count.Unwrap()
		}
		return 0
	}()

	firstName := StringOptionNone()
	firstDisplay := func() string {
		if firstName.IsSome() {
			return firstName.Unwrap()
		}
		return "Anonymous"
	}()

	age := IntOptionNone()
	ageDisplay := func() int {
		if age.IsSome() {
			return age.Unwrap()
		}
		return 18
	}()
}
func getUserName() StringOption {
	return StringOptionNone()
}
func getCount() IntOption {
	return IntOptionSome(42)
}
