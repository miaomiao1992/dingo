package main

type UserOptionTag uint8

const (
	UserOptionTagSome UserOptionTag = iota
	UserOptionTagNone
)

type UserOption struct {
	tag  UserOptionTag
	some *User
}

func UserOptionSome(arg0 User) UserOption {
	return UserOption{tag: UserOptionTagSome, some: &arg0}
}
func UserOptionNone() UserOption {
	return UserOption{tag: UserOptionTagNone}
}
func (e UserOption) IsSome() bool {
	return e.tag == UserOptionTagSome
}
func (e UserOption) IsNone() bool {
	return e.tag == UserOptionTagNone
}
func (o UserOption) Map(fn func(User) User) UserOption {
	switch o.tag {
	case UserOptionTagSome:
		if o.some != nil {
			return UserOptionSome(fn(*o.some))
		}
	case UserOptionTagNone:
		return o
	}
	panic("invalid UserOption state")
}
func (o UserOption) AndThen(fn func(User) UserOption) UserOption {
	switch o.tag {
	case UserOptionTagSome:
		if o.some != nil {
			return fn(*o.some)
		}
	case UserOptionTagNone:
		return o
	}
	panic("invalid UserOption state")
}

type SettingsOptionTag uint8

const (
	SettingsOptionTagSome SettingsOptionTag = iota
	SettingsOptionTagNone
)

type SettingsOption struct {
	tag  SettingsOptionTag
	some *Settings
}
func SettingsOptionSome(arg0 Settings) SettingsOption {
	return SettingsOption{tag: SettingsOptionTagSome, some: &arg0}
}
func SettingsOptionNone() SettingsOption {
	return SettingsOption{tag: SettingsOptionTagNone}
}
func (e SettingsOption) IsSome() bool {
	return e.tag == SettingsOptionTagSome
}
func (e SettingsOption) IsNone() bool {
	return e.tag == SettingsOptionTagNone
}
func (o SettingsOption) Map(fn func(Settings) Settings) SettingsOption {
	switch o.tag {
	case SettingsOptionTagSome:
		if o.some != nil {
			return SettingsOptionSome(fn(*o.some))
		}
	case SettingsOptionTagNone:
		return o
	}
	panic("invalid SettingsOption state")
}
func (o SettingsOption) AndThen(fn func(Settings) SettingsOption) SettingsOption {
	switch o.tag {
	case SettingsOptionTagSome:
		if o.some != nil {
			return fn(*o.some)
		}
	case SettingsOptionTagNone:
		return o
	}
	panic("invalid SettingsOption state")
}

type User struct {
	name     string
	config   *Config
	settings SettingsOption
}
type Config struct {
	theme *Theme
}
type Theme struct {
	color string
}
type Settings struct {
	lang     string
	timezone *Timezone
}
type Timezone struct {
	offset int
}
func getUser(id int) UserOption {
	if id == 1 {
		tz := &Timezone{offset: -5}
		settings := SettingsOptionSome(Settings{lang: "en", timezone: tz})
		theme := &Theme{color: "dark"}
		config := &Config{theme: theme}
		return UserOptionSome(User{name: "Charlie", config: config, settings: settings})
	}
	return UserOptionNone()
}
func main() {

	user := getUser(1)
	color := user
	println("Theme:", color)

	offset := user
	println("Timezone:", offset)

	noUser := getUser(0)
	noColor := noUser
	println("No Theme:", noColor)
}
